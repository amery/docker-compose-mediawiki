# vim: set ft=yaml ts=2 sw=2 et:
version: '3'

volumes:
  wiki:
    driver: local
    driver_opts:
      type: overlay
      o: "lowerdir=${PWD}/mediawiki,upperdir=${PWD}/www,workdir=${PWD}/.www"
      device: overlay

services:

  @@NAME@@:
    container_name: nginx
    image: nginx:alpine

    restart: always
    volumes:
      - "wiki:/srv/http/wiki"
      - "./extensions:/srv/http/wiki/extensions"
      - "./nginx.conf:/etc/nginx/conf.d/default.conf"
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.@@NAME@@.rule=Host(`@@HOSTNAME@@`)"
    networks:
      - @@TRAEFIK_BRIDGE@@

networks:
  @@TRAEFIK_BRIDGE@@:
    external: true
